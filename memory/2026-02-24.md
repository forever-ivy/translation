# 2026-02-24

## Web LLM Gateway Refactor (Gemini Primary, ChatGPT Fallback)

- Implemented multi-provider Playwright Web LLM Gateway:
  - Providers: `gemini_web`, `chatgpt_web`
  - Endpoints: `/health`, `/session`, `/session/diagnose`, `/session/login`, `/v1/chat/completions`
  - Trace artifacts: `_VERIFY/<job_id>/.system/web_calls/<provider>/...` (JSON + screenshot)
- Pipeline/worker changes:
  - Queue claim sets job status to `preflight` before `running`
  - Pipeline preflight checks gateway login readiness (fails fast to `needs_attention`)
  - Fixed artifact validation to use manifest (removed hardcoded `Translated.xlsx` expectation)
- Orchestrator changes for web mode:
  - Web gateway enabled by default
  - Web providers selected via `OPENCLAW_WEB_LLM_PRIMARY`/`OPENCLAW_WEB_LLM_FALLBACK`
  - One generation + one review per round; no in-round regeneration loops
  - Disabled non-web generator path (GLM) when web gateway is enabled
- Tauri updates:
  - Gateway status now includes per-provider map
  - Per-provider login supported (interactive)
  - UI shows provider rows and `preflight` job status

Verification:
- Python unit tests: `python -m unittest discover -s tests -p 'test_*.py'` (292 tests) passed.
- Rust: `cargo check` passed in `tauri-app/src-tauri`.
- Frontend: `npm ci`, `npm run typecheck`, `npm run build` passed in `tauri-app/`.
- Playwright smoke: chromium launch OK.

